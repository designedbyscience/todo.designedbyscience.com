// Generated by CoffeeScript 1.3.3
(function(){window.Modernizr=function(e,t,n){function r(e){p.cssText=e}function i(e,t){return r(m.join(e+";")+(t||""))}function s(e,t){return typeof e===t}function o(e,t){return!!~(""+e).indexOf(t)}function u(e,t,r){for(var i in e){var o=t[e[i]];if(o!==n)return r===!1?e[i]:s(o,"function")?o.bind(r||t):o}return!1}var a="2.5.3",f={},l=t.documentElement,c="modernizr",h=t.createElement(c),p=h.style,d,v={}.toString,m=" -webkit- -moz- -o- -ms- ".split(" "),g={},y={},b={},w=[],E=w.slice,S,x=function(e,n,r,i){var s,o,u,a=t.createElement("div"),f=t.body,h=f?f:t.createElement("body");if(parseInt(r,10))while(r--)u=t.createElement("div"),u.id=i?i[r]:c+(r+1),a.appendChild(u);return s=["&#173;","<style>",e,"</style>"].join(""),a.id=c,(f?a:h).innerHTML+=s,h.appendChild(a),f||(h.style.background="",l.appendChild(h)),o=n(a,e),f?a.parentNode.removeChild(a):h.parentNode.removeChild(h),!!o},T={}.hasOwnProperty,N;!s(T,"undefined")&&!s(T.call,"undefined")?N=function(e,t){return T.call(e,t)}:N=function(e,t){return t in e&&s(e.constructor.prototype[t],"undefined")},Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if(typeof t!="function")throw new TypeError;var n=E.call(arguments,1),r=function(){if(this instanceof r){var i=function(){};i.prototype=t.prototype;var s=new i,o=t.apply(s,n.concat(E.call(arguments)));return Object(o)===o?o:s}return t.apply(e,n.concat(E.call(arguments)))};return r});var C=function(n,r){var i=n.join(""),s=r.length;x(i,function(n,r){var i=t.styleSheets[t.styleSheets.length-1],o=i?i.cssRules&&i.cssRules[0]?i.cssRules[0].cssText:i.cssText||"":"",u=n.childNodes,a={};while(s--)a[u[s].id]=u[s];f.touch="ontouchstart"in e||e.DocumentTouch&&t instanceof DocumentTouch||(a.touch&&a.touch.offsetTop)===9},s,r)}([,["@media (",m.join("touch-enabled),("),c,")","{#touch{top:9px;position:absolute}}"].join("")],[,"touch"]);g.touch=function(){return f.touch};for(var k in g)N(g,k)&&(S=k.toLowerCase(),f[S]=g[k](),w.push((f[S]?"":"no-")+S));return r(""),h=d=null,f._version=a,f._prefixes=m,f.testStyles=x,f}(this,this.document);var e,t,n,r,i,s,o,u,a;o=function(){var e,t;return t=0,e=["/","|","\\","-"],setInterval(function(){return document.getElementById("spinner").innerHTML=e[t],t=t<3?t+1:0,t},100)},s=function(e,t){return Modernizr.touch?e.addEventListener("touchend",t,!1):e.addEventListener("click",t,!1)},a=function(e,t){return Modernizr.touch?e.removeEventListener("touchend",t,!1):e.removeEventListener("click",t,!1)},e=function(){function e(){this.element=document.createElement("div"),this.element.innerHTML="~",this.element.classList.add("processspinner")}return e.prototype.remove=function(){return this.element.parentElement.removeChild(this.element)},e}(),i=function(){function e(){var e;this.console=document.querySelector(".console"),this.days=function(){var t,n,r,i;r=document.querySelectorAll(".day"),i=[];for(t=0,n=r.length;t<n;t++)e=r[t],i.push(this.buildDay(e));return i}.call(this),document.addEventListener("keyup",this.handleEnterKey,!1),document.getElementById("previous").addEventListener("click",this.getDay,!1)}return e.prototype.buildDay=function(e){return new n(e)},e.prototype.outputToConsole=function(e){var t;return t=document.createElement("p"),t.innerHTML=e,this.console.appendChild(t),!0},e.prototype.setCurrentDay=function(){var e,t,n,r,i,s,o;r=new Date,t=r.getDay(),this.activeInput=document.querySelectorAll(".task_entry")[t],this.activeInput.focus(),o=this.days;for(n=i=0,s=o.length;i<s;n=++i)e=o[n],n<t&&e.disable();if(window.innerWidth<=600)return console.log(this.days[t].element.offsetTop),setTimeout(function(){return window.scroll(0,u.days[t].element.offsetTop)},10)},e.prototype.updatePageTitle=function(e){var t,n,r;return e?setTaskCount(1):setTaskCount(-1),t=getTaskCount(),t>1?(document.title=t+" tasks :: todo.designedbyscience.com",(n=window.fluid)!=null?n.dockBadge=t+"":void 0):(document.title=t+" task :: todo.designedbyscience.com",(r=window.fluid)!=null?r.dockBadge=t+"":void 0)},e.prototype.handleEnterKey=function(e){var t,n,r;if(e.keyCode===13)return t=u.activeInput.value,n=u.activeInput.getAttribute("data-date"),r={task_text:t,due_date:n},u.activeInput.object.addTask(r)},e.prototype.getDay=function(e){return console.log(new Date(u.days[0].date-864e5)),encodeURIComponent()},e}(),n=function(){function e(e){this.element=e,this.tasklist=new r(this.element.querySelector(".tasklist")),this.date=new Date(this.tasklist.input.getAttribute("data-js-date")),console.log("@date: "+this.date),this.element.object=this}return e.prototype.disable=function(){return this.element.classList.add("disabled"),console.log("Disabling Task List"),this.tasklist.input.setAttribute("disabled"),a(this.tasklist.element,this.tasklist.handleClick)},e}(),r=function(){function n(e){this.element=e,this.element.object=this,this.tasks=this.buildTasks(),this.input=this.element.querySelector("input"),this.input.object=this,s(this.element,this.handleClick),this.input.addEventListener("focus",this.handleFocus,!1)}return n.prototype.handleFocus=function(e){return u.activeInput=this},n.prototype.buildTasks=function(){var e,n;return n=[],n=function(){var n,r,i,s;i=this.element.querySelectorAll(".task"),s=[];for(n=0,r=i.length;n<r;n++)e=i[n],e.classList.contains("empty")||s.push(new t(e));return s}.call(this)},n.prototype.handleClick=function(e){var t;if(e.target.classList.contains("task")&&!e.target.classList.contains("empty"))return t=e.target.object,t.toggle()},n.prototype.findTask=function(e){var t;return function(){var n,r,i,s;i=this.tasks,s=[];for(n=0,r=i.length;n<r;n++)t=i[n],t.id===e&&s.push(t);return s}.call(this)[0]},n.prototype.addTask=function(n){var r,i,s,o,a;return u.outputToConsole("Sending task..."),r=this.element.querySelector(".empty"),r||(r=t.buildElement(),this.element.appendChild(r)),o=new t(r),o.build(n.task_text),s=new e,o.element.appendChild(s.element),this.input.value="",u.updatePageTitle(!0),a=new XMLHttpRequest,a.open("POST","/todo/",!0),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.onload=function(e){var t;if(this.status===200){console.log(this.response),t=JSON.parse(this.response);if(t.success)return u.outputToConsole("task added"),o.set_id(t.id),s.remove()}},i="task_text="+n.task_text+"&due_date="+n.due_date.toString(),a.send(i.replace(/\s/g,"+")),!0},n}(),t=function(){function e(e){this.element=e,this.element.object=this,this.completed=this.element.classList.contains("completed"),this.id=this.element.getAttribute("data-id")}return e.buildElement=function(){var e;return e=document.createElement("div"),e.classList.add("task"),e},e.prototype.build=function(e){return this.element.classList.add("processing"),this.element.classList.remove("empty"),this.element.innerHTML=e},e.prototype.set_id=function(e){return this.element.setAttribute("data-id",e),this.id=e},e.prototype.toggle=function(){return this.completed?this.uncomplete():this.complete(),this.completed=this.element.classList.contains("completed")},e.prototype.complete=function(){var e;return this.element.classList.add("completed"),u.updatePageTitle(!1),e=new XMLHttpRequest,e.open("POST","/todo/"+this.id,!0),e.onload=function(e){var t;if(this.status===200){t=JSON.parse(this.response);if(t.success)return u.outputToConsole("task completed")}},e.send()},e.prototype.uncomplete=function(){var e;return this.element.classList.remove("completed"),u.updatePageTitle(!0),e=new XMLHttpRequest,e.open("POST","/todo/"+this.id,!0),e.onload=function(e){var t;if(this.status===200){t=JSON.parse(this.response);if(t.success)return u.outputToConsole("task uncompleted")}},e.send()},e}(),u=new i,u.setCurrentDay()}).call(this);